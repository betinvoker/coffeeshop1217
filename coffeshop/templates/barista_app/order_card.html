{% load static %}

<div class="col-12 col-md-6 col-lg-4">
    <div class="card order-card shadow-sm status-{{ order.status }} h-100">
        <div class="card-header bg-white d-flex justify-content-between align-items-center">
            <strong>–ó–∞–∫–∞–∑ #{{ order.id }}</strong>
            <small class="text-muted">{{ order.created_at|date:"d.m.Y H:i" }}</small>
        </div>
        <div class="card-body">
            <p class="card-text mb-2">
                <i class="bi bi-telephone"></i>
                {{ order.user.phone|default:"‚Äî –±–µ–∑ —Ç–µ–ª–µ—Ñ–æ–Ω–∞" }}
            </p>
            <p class="card-text mb-2">
                <i class="bi bi-geo-alt"></i>
                {% if order.order_type == 'delivery' %}
                    {{ order.address|default:"‚Äî –∞–¥—Ä–µ—Å –Ω–µ —É–∫–∞–∑–∞–Ω" }}
                {% else %}
                    üè™ –°–∞–º–æ–≤—ã–≤–æ–∑
                {% endif %}
            </p>
            <hr>
            <h6 class="mb-2">–ü–æ–∑–∏—Ü–∏–∏:</h6>
            <ul class="list-group list-group-flush mb-3">
                {% for item in order.items.all %}
                    <li class="list-group-item px-0 py-1">
                        <small>
                            {{ item.quantity }}√ó 
                            {% if item.item.category.emoji %}{{ item.item.category.emoji }} {% endif %}
                            {{ item.item.name }}
                            {% if item.item.price %}(‚ÇΩ{{ item.item.price }}){% endif %}
                        </small>
                    </li>
                {% empty %}
                    <li class="list-group-item px-0 py-1 text-muted"><small>–ù–µ—Ç –ø–æ–∑–∏—Ü–∏–π</small></li>
                {% endfor %}
            </ul>
            <div class="d-flex justify-content-between align-items-center">
                <strong class="text-success">–ò—Ç–æ–≥–æ: ‚ÇΩ{{ order.total_price }}</strong>
                <span class="badge bg-secondary">
                    {% if order.status == 'pending' %}–û–∂–∏–¥–∞–µ—Ç
                    {% elif order.status == 'confirmed' %}–ì–æ—Ç–æ–≤–∏—Ç—Å—è
                    {% elif order.status == 'completed' %}–ì–æ—Ç–æ–≤
                    {% elif order.status == 'canceled' %}–û—Ç–º–µ–Ω—ë–Ω
                    {% else %}{{ order.get_status_display }}
                    {% endif %}
                </span>
            </div>
        </div>
        <div class="card-footer bg-white">
            <div class="btn-group w-100">
                <a href="{% url 'barista_app:update_status' order.id 'confirmed' %}"
                   class="btn btn-outline-success btn-sm">
                    <i class="bi bi-check2-circle"></i> –ü—Ä–∏–Ω—è—Ç—å
                </a>
                <a href="{% url 'barista_app:update_status' order.id 'completed' %}"
                   class="btn btn-outline-primary btn-sm">
                    <i class="bi bi-check-circle"></i> –ì–æ—Ç–æ–≤
                </a>
                <a href="{% url 'barista_app:update_status' order.id 'canceled' %}"
                   class="btn btn-outline-danger btn-sm"
                   onclick="return confirm('–û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑?')">
                    <i class="bi bi-x-circle"></i> –û—Ç–º–µ–Ω–∞
                </a>
            </div>
        </div>
    </div>
</div>